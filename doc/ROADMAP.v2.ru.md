# dart_swagger_to_api_client — Дорожная карта v2.0

Этот документ описывает дальнейшее развитие пакета `dart_swagger_to_api_client` после завершения базовой функциональности (v0.1-v0.8).

## Текущий статус (v0.8.0)

✅ **Завершено:**
- v0.1-v0.8 полностью реализованы
- Все основные функции работают
- Комплексный набор тестов (173+ тестов)
- Полная документация (en/ru)
- CI/CD шаблоны
- Примеры интеграции со state management

## v1.0 — Стабильность и production-ready

**Цель**: Подготовить пакет к публикации на pub.dev и использованию в production.

### 1.1 Финальная полировка ✅ ЗАВЕРШЕНО

- [x] **Улучшение обработки ошибок**
  - [x] Более детальные сообщения об ошибках с контекстом
  - [x] Stack trace для отладки
  - [x] Валидация конфигурации перед генерацией
  - [x] Новые типы исключений: `GenerationException`, `ConfigValidationException`
  - [x] Контекстная информация в исключениях (path, context, cause)

- [x] **Оптимизация производительности**
  - [x] Кэширование результатов парсинга спецификации (`SpecCache`)
  - [x] Оптимизация генерации больших спецификаций (кэш по хешу файла)
  - [x] Ленивая загрузка моделей в resolver (инициализация только при первом использовании)
  - [x] Защита от конкурентной инициализации в `FileBasedModelsResolver`

- [x] **Улучшение валидации**
  - [x] Более строгая валидация OpenAPI спецификаций
  - [x] Предупреждения о deprecated фичах (Swagger 2.0, consumes/produces, host/basePath/schemes)
  - [x] Проверка совместимости версий OpenAPI (предупреждения для неподдерживаемых версий)
  - [x] Валидация конфигурации (`ConfigValidator`) с детальными сообщениями об ошибках

### 1.2 Документация и примеры

- [ ] **Расширенная документация**
  - [x] README с полным описанием
  - [x] USAGE guide (en/ru)
  - [x] DEVELOPERS guide (en/ru)
  - [x] CONTEXT для LLM (en/ru)
  - [x] FAQ (en/ru)
  - [x] Troubleshooting guide (en/ru)
  - [x] API Reference документация
  - [ ] Migration guide (если будут breaking changes)

- [ ] **Дополнительные примеры**
  - [ ] Примеры для различных типов API (REST, GraphQL через REST)
  - [ ] Примеры для различных сценариев аутентификации (OAuth2, JWT refresh)
  - [ ] Примеры для различных типов данных (streaming, binary)

### 1.3 Тестирование

- [x] **Расширение тестового покрытия**
  - [x] Достичь 70%+ покрытия кода (фактически ~72.6% по состоянию на v1.0.0)
  - [x] Тесты для всех edge cases
  - [x] Performance тесты для больших спецификаций
  - [x] Тесты совместимости с различными версиями Dart

- [x] **Интеграционные тесты**
  - [x] Тесты с реальными API (опционально, через httpbin.org)
  - [x] Тесты с различными OpenAPI версиями (3.0.0, 3.1.0, Swagger 2.0)
  - [x] Тесты с различными конфигурациями (базовые, профили окружений, адаптеры)

### 1.4 Публикация

- [x] **Подготовка к публикации**
  - [x] Финальная проверка всех зависимостей (`dart pub get`, ручная проверка версий)
  - [x] Проверка совместимости с текущей стабильной версией Dart (`dart test`, `dart analyze`)
  - [x] Создание и актуализация changelog (раздел `## 1.0.0`)
  - [x] Подготовка release notes (на основе CHANGELOG/README)
  - [ ] Публикация на pub.dev (`dart pub publish`)

---

## v1.1 — Расширенные возможности OpenAPI

**Цель**: Поддержка большего количества OpenAPI фич для покрытия реальных API.

### 1.1.1 Расширенная поддержка параметров ✅ ЗАВЕРШЕНО

- [x] **Массивы параметров**
  - [x] Поддержка `array` типов в query параметрах
  - [x] Правильная сериализация массивов (comma-separated, pipe-separated, space-separated)
  - [x] Поддержка `explode` опции (form + explode использует queryParametersAll)

- [x] **Сложные типы параметров**
  - [x] Поддержка `object` типов в query параметрах
  - [x] Поддержка вложенных объектов
  - [x] Deep object serialization (style: deepObject)

- [x] **Параметры на уровне path**
  - [x] Поддержка параметров, определенных на уровне path item
  - [x] Правильное наследование параметров (operation-level переопределяет path-level)

### 1.1.2 Расширенная поддержка requestBody ✅ ЗАВЕРШЕНО

- [x] **Множественные content types (этап 1)**
  - [x] Базовая поддержка нескольких content types для одного endpoint
  - [x] Поддержка `text/plain`, `text/html`, `application/xml`
  - [x] Поддержка кастомных content types
  - [x] Приоритетный выбор content type (multipart > form-urlencoded > json > text/plain > text/html > xml > другие)
  - [x] Правильная генерация типов body для разных content types (String для text, Map для JSON/XML)

- [ ] **Умный выбор content type (этап 2, после v1.1.0)**
  - [ ] Автоматический выбор content type на основе данных/конфигурации

- [ ] **Условные requestBody (oneOf) — расширенная фича**
  - [ ] Поддержка `oneOf` в requestBody
  - [ ] Генерация перегруженных методов для разных типов
  - > Может быть реализовано поэтапно в v1.1.x / v1.2, требует аккуратного дизайна типов

- [ ] **Streaming uploads**
  - [ ] Поддержка streaming для больших файлов (на уровне HttpRequest/адаптеров)
  - [ ] Progress callbacks для uploads

### 1.1.3 Расширенная поддержка responses

- [ ] **Множественные response схемы (oneOf/anyOf) — расширенная фича**
  - [ ] Поддержка `oneOf`, `anyOf` в responses
  - [ ] Генерация union типов для responses
  - [ ] Discriminator support
  - > Требует продуманной модели типов и может быть вынесено в отдельный минорный релиз

- [x] **Response headers** ✅ ЗАВЕРШЕНО
  - [x] Генерация типов для response headers
  - [x] Доступ к headers в сгенерированном коде
  - [x] Автоматический парсинг headers из OpenAPI спецификации
  - [x] Класс `ApiResponse<T>` для обертки response с headers
  - [x] Поддержка required и optional headers (nullable типы)
  - [x] Обратная совместимость: методы без headers возвращают данные напрямую

- [ ] **Streaming responses**
  - [ ] Поддержка streaming responses
  - [ ] Генерация методов для streaming данных

### 1.1.4 Security schemes ✅ ЗАВЕРШЕНО

- [x] **Расширенная аутентификация**
  - [x] OAuth2 support (access token через resolveOAuth2AccessToken)
  - [x] OpenID Connect support (token через resolveOpenIdConnectToken)
  - [x] API Key в различных местах (cookie, header, query) - полная поддержка
  - [x] HTTP Basic authentication (через resolveBasicAuthUsername/Password)
  - [x] HTTP Bearer authentication (с поддержкой bearerFormat)

- [x] **Security на уровне операций**
  - [x] Поддержка различных security schemes для разных операций
  - [x] Генерация методов с правильной аутентификацией
  - [x] Operation-level security переопределяет global security
  - [x] Парсинг security schemes из OpenAPI 3.0 и Swagger 2.0

---

## v1.2 — Улучшение Developer Experience

**Цель**: Сделать использование пакета максимально удобным и продуктивным.

### 1.2.1 Интерактивный режим

- [ ] **Интерактивная генерация**
  - [ ] Выбор конкретных endpoints для генерации
  - [ ] Предпросмотр изменений перед генерацией
  - [ ] Интерактивная настройка конфигурации

- [ ] **Diff preview**
  - [ ] Показ diff перед перезаписью файлов
  - [ ] Возможность отменить изменения
  - [ ] Сохранение backup копий

### 1.2.2 Улучшение watch-режима

- [ ] **Умный watch-режим**
  - [ ] Отслеживание только измененных частей спецификации
  - [ ] Инкрементальная регенерация
  - [ ] Уведомления о изменениях

- [ ] **Интеграция с IDE (low priority / community-friendly)**
  - [ ] Плагин для VS Code / IntelliJ
  - [ ] Автоматическая регенерация при сохранении
  - [ ] Показ ошибок в IDE
  - > Желательно реализовывать после стабилизации CLI + build_runner, хорошая зона для внешнего вклада

### 1.2.3 Улучшение CLI

- [ ] **Расширенные команды**
  - [ ] `validate` — валидация спецификации без генерации
  - [ ] `diff` — показ различий между текущим и новым клиентом
  - [ ] `clean` — очистка сгенерированных файлов

- [ ] **Улучшенный вывод**
  - [ ] Цветной вывод для лучшей читаемости
  - [ ] Progress bar для длительных операций
  - [ ] Статистика генерации (количество методов, моделей, etc.)

### 1.2.4 build_runner интеграция

- [ ] **Автоматическая генерация**
  - [ ] Builder для автоматической генерации в build pipeline (поверх существующей CLI-логики, без дублирования кода)
  - [ ] Интеграция с `dart_swagger_to_models` builder
  - [ ] Поддержка incremental builds

---

## v1.3 — Расширенные middleware и паттерны

**Цель**: Предоставить готовые решения для типичных задач.

### 1.3.1 Дополнительные middleware

- [ ] **Caching middleware**
  - [ ] Кэширование ответов по ключам (метод + URL + query + body hash)
  - [ ] TTL для кэшированных данных
  - [ ] Инвалидация кэша (по ключам/паттернам и по событиям запросов)

- [ ] **Request deduplication**
  - [ ] Предотвращение дублирующих запросов
  - [ ] Объединение одинаковых запросов

- [ ] **Request queuing**
  - [ ] Очередь запросов с приоритетами
  - [ ] Batch requests

- [ ] **Metrics middleware**
  - [ ] Сбор метрик (latency, success rate, etc.)
  - [ ] Экспорт метрик в различные форматы

- [ ] **Документация по middleware**
  - [ ] Отдельный раздел в документации по встроенным middleware (Logging, Retry, CircuitBreaker, RateLimit, Transformer, Caching)
  - [ ] Примеры композиций middleware (logging + retry + circuit breaker + caching)

### 1.3.2 Расширенные паттерны

- [ ] **Pagination helpers**
  - [ ] Автоматическая генерация pagination методов (поверх уже существующего детектора пагинации)
  - [ ] Cursor-based pagination
  - [ ] Offset-based pagination
  - [ ] Infinite scroll helpers

- [ ] **WebSocket support**
  - [ ] Генерация WebSocket клиентов из OpenAPI
  - [ ] Поддержка WebSocket в адаптерах

- [ ] **GraphQL через REST (experimental / long-term)**
  - [ ] Генерация GraphQL-like методов для REST API
  - [ ] Field selection для responses
  - > Требует отдельного исследования и прототипа, реалистично — после стабилизации v1.x

---

## v1.4 — Интеграции и экосистема

**Цель**: Интеграция с популярными инструментами и фреймворками.

### 1.4.1 State Management интеграции

- [x] **Riverpod примеры** — ЗАВЕРШЕНО
- [x] **BLoC примеры** — ЗАВЕРШЕНО
- [ ] **GetX интеграция**
  - [ ] Примеры использования с GetX
  - [ ] Генерация GetX контроллеров

- [ ] **MobX интеграция**
  - [ ] Примеры использования с MobX
  - [ ] Генерация MobX stores

### 1.4.2 Flutter интеграции

- [ ] **Flutter-specific features**
  - [ ] Поддержка Flutter-specific типов (Image, File, etc.)
  - [ ] Интеграция с Flutter file picker
  - [ ] Поддержка Flutter image picker

- [ ] **Code generation для Flutter**
  - [ ] Генерация виджетов для API вызовов
  - [ ] Генерация форм из OpenAPI schemas

### 1.4.3 Инструменты разработки

- [ ] **VS Code extension**
  - [ ] Автоматическая регенерация при изменении spec
  - [ ] Подсветка синтаксиса для сгенерированного кода
  - [ ] IntelliSense для API методов

- [ ] **IntelliJ/Android Studio plugin**
  - [ ] Аналогичная функциональность для IntelliJ

- [ ] **CLI improvements**
  - [ ] Автодополнение для команд
  - [ ] Shell completion scripts

---

## v1.5 — Производительность и масштабируемость

**Цель**: Оптимизация для больших проектов и высоких нагрузок.

### 1.5.1 Оптимизация генерации

- [ ] **Параллельная генерация**
  - [ ] Параллельная обработка endpoints
  - [ ] Параллельная загрузка моделей

- [ ] **Инкрементальная генерация**
  - [ ] Генерация только измененных частей
  - [ ] Кэширование результатов парсинга

- [ ] **Оптимизация больших спецификаций**
  - [ ] Ленивая загрузка частей спецификации
  - [ ] Оптимизация памяти при обработке

### 1.5.2 Оптимизация runtime

- [ ] **Connection pooling**
  - [ ] Переиспользование HTTP соединений
  - [ ] Настройка pool size

- [ ] **Request batching**
  - [ ] Автоматическое объединение запросов
  - [ ] Batch API support

- [ ] **Compression**
  - [ ] Автоматическое сжатие запросов/ответов
  - [ ] Поддержка различных алгоритмов сжатия

---

## v2.0 — Будущие возможности

**Цель**: Долгосрочное развитие и инновации.

### 2.1 Расширенная поддержка OpenAPI 3.1

- [ ] **Полная поддержка OpenAPI 3.1**
  - [ ] Все новые фичи OpenAPI 3.1 (поверх уже поддерживаемых базовых сценариев)
  - [ ] Webhooks support
  - [ ] Расширенная поддержка JSON Schema 2020-12

### 2.2 Code generation improvements

- [ ] **Генерация документации**
  - [ ] Автоматическая генерация API документации
  - [ ] JSDoc-style комментарии для методов
  - [ ] Примеры использования в комментариях

- [ ] **Генерация тестов**
  - [ ] Автоматическая генерация unit тестов
  - [ ] Генерация mock данных
  - [ ] Генерация integration тестов

- [ ] **Генерация валидации**
  - [ ] Валидация request/response на основе схем
  - [ ] Runtime валидация данных

### 2.3 Расширенные возможности

- [ ] **Multi-version API support**
  - [ ] Поддержка нескольких версий API одновременно
  - [ ] Автоматическое переключение версий

- [ ] **API versioning**
  - [ ] Генерация клиентов для разных версий API
  - [ ] Миграция между версиями

- [ ] **Custom code templates**
  - [ ] Возможность кастомизации шаблонов генерации
  - [ ] Поддержка различных стилей кода

### 2.4 Интеграция с другими инструментами

- [ ] **Postman integration**
  - [ ] Экспорт в Postman collection
  - [ ] Импорт из Postman

- [ ] **Insomnia integration**
  - [ ] Экспорт в Insomnia
  - [ ] Импорт из Insomnia

- [ ] **API Gateway integration**
  - [ ] Интеграция с AWS API Gateway
  - [ ] Интеграция с Azure API Management

---

## Приоритеты развития

### Высокий приоритет (v1.0-v1.1)

1. **Стабильность и production-ready** (v1.0)
   - Финальная полировка
   - Расширенное тестирование
   - Публикация на pub.dev

2. **Расширенная поддержка OpenAPI** (v1.1)
   - Массивы параметров
   - Множественные content types (этап 1)
   - Расширенная аутентификация

### Средний приоритет (v1.2-v1.3)

3. **Улучшение DX** (v1.2)
   - Интерактивный режим
   - build_runner интеграция
   - Улучшение CLI

4. **Расширенные middleware и паттерны** (v1.3)
   - Caching
   - Request deduplication
   - Pagination helpers
   - Документация по middleware

### Низкий приоритет (v1.4-v2.0)

5. **Интеграции** (v1.4)
   - VS Code extension
   - Дополнительные state management интеграции

6. **Производительность** (v1.5)
   - Оптимизация генерации
   - Оптимизация runtime

7. **Будущие возможности** (v2.0)
   - OpenAPI 3.1 полная поддержка
   - Генерация тестов и документации

---

## Как внести вклад

Мы приветствуем вклад в развитие проекта! Вот несколько способов помочь:

1. **Сообщения об ошибках**: Открывайте issues на GitHub
2. **Предложения фич**: Обсуждайте новые идеи в issues
3. **Pull requests**: Присылайте PR с улучшениями
4. **Документация**: Помогайте улучшать документацию
5. **Примеры**: Создавайте примеры использования

## Связанные проекты

- [`dart_swagger_to_models`](https://github.com/AlexGalitsky/dart_swagger_to_models) — Генерация моделей из OpenAPI
- [OpenAPI Specification](https://swagger.io/specification/) — Спецификация OpenAPI

---

**Последнее обновление**: После завершения v0.8.0 и создания полной документации.